# Towards-AI-Based-Anomaly-Detection-at-the-Edge-Evaluating-Real-Time-CyberDefense-in-PLC

This repository contains the research tools, trained artifacts, and PLC projects used in our work on executing deep learning–based anomaly detection directly inside Siemens PLCs.

The purpose of this repository is to document the structure of the project and provide all files required to reproduce the experiments and PLC deployments.

---

## Repository structure

- [Models/](./Models)
- [Notebooks/](./Notebooks)
- [PLC_Projects/](./PLC_Projects)
- [PLC_Timing_Evaluation/](./PLC_Timing_Evaluation)
- [README.md](./README.md)

---

### Detailed project layout

The following tree summarizes the internal organization of the repository and highlights how trained models, PLC projects, and timing evaluation artifacts are separated.

```text
Towards-AI-Based-Anomaly-Detection-at-the-Edge/
│
├── Models/
│   ├── HS8_IW{10,50,100}/
│   │   ├── evaluation_log_epoch_xx/
│   │   └── plc_export_epoch_xx/
│   ├── HS16_IW{10,50,100}/
│   │   ├── evaluation_log_epoch_xx/
│   │   └── plc_export_epoch_xx/
│   └── HS32_IW{10,50,100}/
│       ├── evaluation_log_epoch_xx/
│       └── plc_export_epoch_xx/
│
├── Notebooks/
│
├── PLC_Projects/
│   ├── Single_Cycle/
│   │   ├── S7_1500_HS16_IW10/
│   │   ├── S7_1500_HS16_IW100/
│   │   └── Supplementary_Projects/
│   │
│   └── Step_Wise/
│       ├── PLC_Supplementary_Projects/
│       └── S7_1500_HS16_IW100/
│
└── PLC_Timing_Evaluation/
    ├── Single_Cycle_Implementation/
    │   ├── data/
    │   └── traces/
    └── Step_Wise_Implementation/
        ├── data/
        └── Traces/

```

## Folder descriptions

### Notebooks/  
Python and Jupyter notebooks used for all offline work, including data processing, model training, evaluation, and export utilities for PLC deployment.

---

### Models/  
These files are generated by the notebooks and serve as direct inputs for the PLC projects.  
This folder contains the structured outputs of the offline experiments, organized by model configuration (hidden size and input window length).

Each configuration directory (e.g., `HS16_IW50/`) typically contains:
- `evaluation_log_epoch_xx/`  
  Offline evaluation results, logs, metrics, and exported artifacts produced by the training and evaluation notebooks.
- `plc_export_epoch_xx/`  
  PLC-ready export packages, including trained weights converted to Siemens Data Blocks and auxiliary files required for on-controller deployment.

---

### PLC_Projects/  
Siemens TIA Portal v19 projects.

This folder contains all PLC-side implementations used in the study, organized by execution strategy.

- `Step_Wise/`
  Step-wise PLC implementations where the inference workflow is split across multiple PLC scan cycles (separate stages per scan), used for feasibility validation, debugging, and phase-level timing inspection.

- `Single_Cycle/`
  Single-cycle PLC implementations where the recurring loop (prediction → evaluation → window shift → next-sample normalization) is executed within one deterministic PLC scan cycle, after a one-time initialization that fills the input window.

- `PLC_Supplementary_Projects/`  
  Supplementary PLC projects (`.zap19`) and Structured Text (`.scl`) exports of the main implementations.  
  These are provided to simplify re-use and re-implementation, and to enable compatibility with older TIA Portal versions (e.g., v17), where full project import may not be supported.

---

### PLC_Timing_Evaluation/  
Cycle-time measurement results of the PLC implementations.

This folder contains execution-time measurements obtained on real Siemens S7-1500 hardware and in PLCSIM Advanced, organized by implementation strategy.

- `Single_Cycle_Implementation/`  
  Timing results of the single-cycle PLC implementations across multiple model configurations.

- `Step_Wise_Implementation/`  
  Timing results of the step-wise PLC implementations, where the inference workflow is distributed across multiple PLC scan cycles.


Each implementation folder follows the same structure:
- `data/` — raw exported cycle-time measurements (`.csv`) from real and virtual PLC runs  
- `traces/` — exported trace recordings (`.png`) captured with the Siemens TIA Portal Trace functionality during PLC execution

---

## Reproducibility notes
- The SWaT dataset is not included in this repository and must be obtained separately.
- All offline experiments and exports were generated using the notebooks provided in `Notebooks/`.
- PLC projects were developed and evaluated on a Siemens S7-1500 CPU 1515F-2 PN and in Siemens PLCSIM Advanced v19.


---
## Citation

If you use this repository in academic work, please cite the associated manuscript currently under review:
“Towards AI-Based Anomaly Detection at the Edge: Evaluating Real-Time Cyber Defense in Programmable Logic Controllers“

---

## Legal Notice

- **Author:** Anonymous  
- **Contact:** To be provided upon publication  
- **License:** Creative Commons Attribution-NonCommercial 4.0 International (CC BY-NC 4.0)  
- **Copyright:** © 2025–2026  

This repository and all included materials are provided exclusively for **educational and research purposes**, and for other **non-commercial use**.

Use in **industrial or production environments** is not permitted.

The **author must be credited** in all derivative or redistributive works.

Any **commercial use** requires **explicit written permission** from the author.

